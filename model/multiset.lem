open import Pervasives
import Map

type t 'k = Map.map 'k nat

val emp: forall 'k. MapKeyType 'k => t 'k
let emp = Map.empty

val count: forall 'k. MapKeyType 'k => 'k -> t 'k -> nat
let count e m =
  Map.findWithDefault e 0 m

let mem e m = (count e m > 0)
let add e m = Map.insert e (1 + count e m) m

let from_list ls = foldl (fun m e -> add e m) emp ls

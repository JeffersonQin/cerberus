{- The coherence axioms CoWW and CoWR forbid that the load reads from the first write. 
   The only allowed outcome is therefore 1.
-}

fun main () : [integer] :=
  x <- create(_Atomic(signed int));
  store(_Atomic(signed int), x, 0, release);
  store(_Atomic(signed int), x, 1, release);
  a <- load(_Atomic(signed int), x, acquire);
  kill(x);
  ret a
